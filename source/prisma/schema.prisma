generator client {
  provider = "prisma-client-js"
}

datasource db {
  url      = env("DB_URL")
  provider = "postgresql"
}

enum Role {
  USER
  ADMIN
}

enum RequestStatus {
  PENDING
  ACCEPTED
}

model User {
  id        Int     @id @default(autoincrement())
  // main part
  username  String? @unique
  firstName String
  lastName  String
  email     String  @unique
  password  String
  // - - -
  role      Role    @default(USER)

  friends   Friend[] @relation("Friends")
  friended  Friend[] @relation("Friended")

  createdAt DateTime  @default(now())
  updatedAt DateTime  @updatedAt
}

model Friend {
  id        Int  @id @default(autoincrement())
  from      User @relation("Friends", fields: [fromId], references: [id])
  fromId    Int
  to        User @relation("Friended", fields: [toId], references: [id])
  toId      Int

  status    RequestStatus

  createdAt DateTime @default(now())

  @@unique([fromId, toId])
}
